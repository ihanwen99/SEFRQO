{"Plan": {"Node Type": "Sort", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 115578.12, "Total Cost": 115578.13, "Plan Rows": 1, "Plan Width": 152, "Actual Startup Time": 966.42, "Actual Total Time": 974.085, "Actual Rows": 243, "Actual Loops": 1, "Sort Key": ["inv1.w_warehouse_sk NULLS FIRST", "inv1.i_item_sk NULLS FIRST", "inv1.mean NULLS FIRST", "inv1.cov NULLS FIRST", "inv2.mean NULLS FIRST", "inv2.cov NULLS FIRST"], "Sort Method": "quicksort", "Sort Space Used": 46, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "InitPlan", "Subplan Name": "CTE inv", "Parallel Aware": false, "Async Capable": false, "Alias": "foo", "Startup Cost": 105403.66, "Total Cost": 114700.69, "Plan Rows": 19401, "Plan Width": 166, "Actual Startup Time": 337.087, "Actual Total Time": 966.98, "Actual Rows": 33696, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 105403.66, "Total Cost": 114603.69, "Plan Rows": 19401, "Plan Width": 134, "Actual Startup Time": 337.085, "Actual Total Time": 963.171, "Actual Rows": 33696, "Actual Loops": 1, "Group Key": ["warehouse.w_warehouse_sk", "item.i_item_sk", "date_dim.d_moy"], "Filter": "(CASE avg(inventory.inv_quantity_on_hand) WHEN '0'::numeric THEN '0'::numeric ELSE ((stddev_samp(inventory.inv_quantity_on_hand) * 1.000) / avg(inventory.inv_quantity_on_hand)) END > '1'::numeric)", "Rows Removed by Filter": 506304, "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 105403.66, "Total Cost": 112372.57, "Plan Rows": 58203, "Plan Width": 74, "Actual Startup Time": 337.03, "Actual Total Time": 562.912, "Actual Rows": 2340000, "Actual Loops": 1, "Workers Planned": 4, "Workers Launched": 4, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 104403.6, "Total Cost": 104439.98, "Plan Rows": 14551, "Plan Width": 74, "Actual Startup Time": 334.773, "Actual Total Time": 364.464, "Actual Rows": 468000, "Actual Loops": 5, "Sort Key": ["warehouse.w_warehouse_sk", "item.i_item_sk", "date_dim.d_moy"], "Sort Method": "external merge", "Sort Space Used": 19344, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 19048, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 18864, "Sort Space Type": "Disk"}, {"Worker Number": 2, "Sort Method": "external merge", "Sort Space Used": 18904, "Sort Space Type": "Disk"}, {"Worker Number": 3, "Sort Method": "external merge", "Sort Space Used": 19504, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2729.06, "Total Cost": 103397.48, "Plan Rows": 14551, "Plan Width": 74, "Actual Startup Time": 88.26, "Actual Total Time": 231.955, "Actual Rows": 468000, "Actual Loops": 5, "Inner Unique": true, "Hash Cond": "(inventory.inv_warehouse_sk = warehouse.w_warehouse_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2716.81, "Total Cost": 103345.41, "Plan Rows": 14551, "Plan Width": 16, "Actual Startup Time": 88.226, "Actual Total Time": 203.074, "Actual Rows": 468000, "Actual Loops": 5, "Inner Unique": true, "Hash Cond": "(inventory.inv_item_sk = item.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1963.79, "Total Cost": 102554.18, "Plan Rows": 14551, "Plan Width": 16, "Actual Startup Time": 86.776, "Actual Total Time": 164.831, "Actual Rows": 468000, "Actual Loops": 5, "Inner Unique": true, "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "inventory", "Alias": "inventory", "Startup Cost": 0.0, "Total Cost": 92882.33, "Plan Rows": 2936233, "Plan Width": 16, "Actual Startup Time": 0.006, "Actual Total Time": 74.762, "Actual Rows": 2349000, "Actual Loops": 5, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1961.12, "Total Cost": 1961.12, "Plan Rows": 213, "Plan Width": 8, "Actual Startup Time": 0.982, "Actual Total Time": 0.983, "Actual Rows": 73, "Actual Loops": 5, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 168, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1961.12, "Plan Rows": 213, "Plan Width": 8, "Actual Startup Time": 0.484, "Actual Total Time": 0.954, "Actual Rows": 73, "Actual Loops": 5, "Filter": "(d_year = 2001)", "Rows Removed by Filter": 14537, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 528.03, "Total Cost": 528.03, "Plan Rows": 18000, "Plan Width": 4, "Actual Startup Time": 1.402, "Actual Total Time": 1.403, "Actual Rows": 18000, "Actual Loops": 5, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 889, "Workers": [], "Plans": [{"Node Type": "Index Only Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "item_pkey", "Relation Name": "item", "Alias": "item", "Startup Cost": 0.29, "Total Cost": 528.03, "Plan Rows": 18000, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.62, "Actual Rows": 18000, "Actual Loops": 5, "Heap Fetches": 0, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 11.0, "Total Cost": 11.0, "Plan Rows": 100, "Plan Width": 62, "Actual Startup Time": 0.011, "Actual Total Time": 0.011, "Actual Rows": 5, "Actual Loops": 5, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "warehouse", "Alias": "warehouse", "Startup Cost": 0.0, "Total Cost": 11.0, "Plan Rows": 100, "Plan Width": 62, "Actual Startup Time": 0.007, "Actual Total Time": 0.008, "Actual Rows": 5, "Actual Loops": 5, "Workers": []}]}]}]}]}]}]}, {"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 437.98, "Total Cost": 877.42, "Plan Rows": 1, "Plan Width": 152, "Actual Startup Time": 965.024, "Actual Total Time": 966.386, "Actual Rows": 243, "Actual Loops": 1, "Inner Unique": false, "Hash Cond": "((inv1.i_item_sk = inv2.i_item_sk) AND (inv1.w_warehouse_sk = inv2.w_warehouse_sk))", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "inv", "Alias": "inv1", "Startup Cost": 0.0, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 337.247, "Actual Total Time": 338.456, "Actual Rows": 3080, "Actual Loops": 1, "Filter": "(d_moy = 1)", "Rows Removed by Filter": 30616}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 436.52, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 627.761, "Actual Total Time": 627.762, "Actual Rows": 3170, "Actual Loops": 1, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 232, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "inv", "Alias": "inv2", "Startup Cost": 0.0, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 0.002, "Actual Total Time": 627.467, "Actual Rows": 3170, "Actual Loops": 1, "Filter": "(d_moy = 2)", "Rows Removed by Filter": 30526}]}]}]}, "Planning Time": 0.566, "Triggers": [], "Execution Time": 975.605}