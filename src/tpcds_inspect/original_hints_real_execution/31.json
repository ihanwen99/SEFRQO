{"Plan": {"Node Type": "Nested Loop", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 553796.89, "Total Cost": 683098.59, "Plan Rows": 1, "Plan Width": 210, "Actual Startup Time": 1206.646, "Actual Total Time": 3248.694, "Actual Rows": 51, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(((ss1.ca_county)::text = (ws2.ca_county)::text) AND (CASE WHEN (ws1.web_sales > '0'::numeric) THEN ((ws2.web_sales * 1.0000) / ws1.web_sales) ELSE NULL::numeric END > CASE WHEN (ss1.store_sales > '0'::numeric) THEN ((ss2.store_sales * 1.0000) / ss1.store_sales) ELSE NULL::numeric END) AND (CASE WHEN (ws2.web_sales > '0'::numeric) THEN ((ws3.web_sales * 1.0000) / ws2.web_sales) ELSE NULL::numeric END > CASE WHEN (ss2.store_sales > '0'::numeric) THEN ((ss3.store_sales * 1.0000) / ss2.store_sales) ELSE NULL::numeric END))", "Rows Removed by Join Filter": 546924, "Plans": [{"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ss", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 345015.59, "Total Cost": 402953.01, "Plan Rows": 1484184, "Plan Width": 54, "Actual Startup Time": 850.066, "Actual Total Time": 855.104, "Actual Rows": 35136, "Actual Loops": 1, "Group Key": ["customer_address.ca_county", "date_dim.d_qoy", "date_dim.d_year"], "Planned Partitions": 32, "HashAgg Batches": 1, "Peak Memory Usage": 15889, "Disk Usage": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5328.6, "Total Cost": 101052.92, "Plan Rows": 2880740, "Plan Width": 28, "Actual Startup Time": 14.258, "Actual Total Time": 576.789, "Actual Rows": 2685273, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(store_sales.ss_addr_sk = customer_address.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3067.6, "Total Cost": 91229.37, "Plan Rows": 2880740, "Plan Width": 18, "Actual Startup Time": 8.216, "Actual Total Time": 389.802, "Actual Rows": 2750311, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 80599.4, "Plan Rows": 2880740, "Plan Width": 14, "Actual Startup Time": 0.009, "Actual Total Time": 109.192, "Actual Rows": 2880404, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2154.49, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 8.057, "Actual Total Time": 8.058, "Actual Rows": 73049, "Actual Loops": 1, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4163, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 0.002, "Actual Total Time": 4.218, "Actual Rows": 73049, "Actual Loops": 1}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1636.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 5.965, "Actual Total Time": 5.966, "Actual Rows": 50000, "Actual Loops": 1, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3052, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 0.006, "Actual Total Time": 3.028, "Actual Rows": 50000, "Actual Loops": 1}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ws", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 96046.31, "Total Cost": 114873.94, "Plan Rows": 719384, "Plan Width": 54, "Actual Startup Time": 251.346, "Actual Total Time": 255.573, "Actual Rows": 23320, "Actual Loops": 1, "Group Key": ["customer_address_1.ca_county", "date_dim_1.d_qoy", "date_dim_1.d_year"], "Planned Partitions": 16, "HashAgg Batches": 1, "Peak Memory Usage": 11281, "Disk Usage": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5328.6, "Total Cost": 35123.48, "Plan Rows": 719384, "Plan Width": 28, "Actual Startup Time": 14.13, "Actual Total Time": 173.387, "Actual Rows": 719118, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_addr_sk = customer_address_1.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3067.6, "Total Cost": 30973.94, "Plan Rows": 719384, "Plan Width": 18, "Actual Startup Time": 8.228, "Actual Total Time": 116.946, "Actual Rows": 719195, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 26017.84, "Plan Rows": 719384, "Plan Width": 14, "Actual Startup Time": 0.006, "Actual Total Time": 34.317, "Actual Rows": 719384, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2154.49, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 8.073, "Actual Total Time": 8.075, "Actual Rows": 73049, "Actual Loops": 1, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4163, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 0.003, "Actual Total Time": 4.408, "Actual Rows": 73049, "Actual Loops": 1}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1636.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 5.825, "Actual Total Time": 5.826, "Actual Rows": 50000, "Actual Loops": 1, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3052, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 0.005, "Actual Total Time": 2.942, "Actual Rows": 50000, "Actual Loops": 1}]}]}]}, {"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 147286.17, "Plan Rows": 1, "Plan Width": 554, "Actual Startup Time": 1120.481, "Actual Total Time": 2888.81, "Actual Rows": 585, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss3.ca_county)::text)", "Rows Removed by Join Filter": 1064916, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 110181.11, "Plan Rows": 1, "Plan Width": 444, "Actual Startup Time": 1120.331, "Actual Total Time": 2338.657, "Actual Rows": 589, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss2.ca_county)::text)", "Rows Removed by Join Filter": 1046635, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 73076.05, "Plan Rows": 1, "Plan Width": 334, "Actual Startup Time": 1109.654, "Actual Total Time": 1744.889, "Actual Rows": 632, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ws1.ca_county)::text)", "Rows Removed by Join Filter": 1125616, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 35970.15, "Plan Rows": 2, "Plan Width": 220, "Actual Startup Time": 259.52, "Actual Total Time": 260.042, "Actual Rows": 668, "Actual Loops": 1, "Inner Unique": false, "Merge Cond": "((ws1.ca_county)::text = (ws3.ca_county)::text)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 17984.98, "Total Cost": 17985.02, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 258.388, "Actual Total Time": 258.458, "Actual Rows": 942, "Actual Loops": 1, "Sort Key": ["ws1.ca_county"], "Sort Method": "quicksort", "Sort Space Used": 71, "Sort Space Type": "Memory", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws1", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 251.38, "Actual Total Time": 258.009, "Actual Rows": 942, "Actual Loops": 1, "Filter": "((d_qoy = 1) AND (d_year = 2000))", "Rows Removed by Filter": 22378}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 17984.98, "Total Cost": 17985.02, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 1.127, "Actual Total Time": 1.235, "Actual Rows": 1260, "Actual Loops": 1, "Sort Key": ["ws3.ca_county"], "Sort Method": "quicksort", "Sort Space Used": 111, "Sort Space Type": "Memory", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws3", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 0.002, "Actual Total Time": 0.597, "Actual Rows": 1261, "Actual Loops": 1, "Filter": "((d_year = 2000) AND (d_qoy = 3))", "Rows Removed by Filter": 22059}]}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss1", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 114, "Actual Startup Time": 1.273, "Actual Total Time": 2.181, "Actual Rows": 1686, "Actual Loops": 668, "Filter": "((d_qoy = 1) AND (d_year = 2000))", "Rows Removed by Filter": 33450}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss2", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Actual Startup Time": 0.0, "Actual Total Time": 0.898, "Actual Rows": 1657, "Actual Loops": 632, "Filter": "((d_year = 2000) AND (d_qoy = 2))", "Rows Removed by Filter": 33479}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss3", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Actual Startup Time": 0.001, "Actual Total Time": 0.889, "Actual Rows": 1809, "Actual Loops": 589, "Filter": "((d_year = 2000) AND (d_qoy = 3))", "Rows Removed by Filter": 33327}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws2", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 0.001, "Actual Total Time": 0.589, "Actual Rows": 935, "Actual Loops": 585, "Filter": "((d_year = 2000) AND (d_qoy = 2))", "Rows Removed by Filter": 22385}]}, "Planning Time": 1.037, "Triggers": [], "Execution Time": 3250.548}