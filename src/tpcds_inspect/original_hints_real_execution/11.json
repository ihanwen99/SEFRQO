{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1246529.84, "Total Cost": 1246529.85, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 918269.276, "Actual Total Time": 918273.121, "Actual Rows": 88, "Actual Loops": 1, "Plans": [{"Node Type": "Append", "Parent Relationship": "InitPlan", "Subplan Name": "CTE year_total", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 211814.25, "Total Cost": 868484.26, "Plan Rows": 3600124, "Plan Width": 255, "Actual Startup Time": 633.326, "Actual Total Time": 2271.628, "Actual Rows": 247230, "Actual Loops": 1, "Subplans Removed": 0, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 211814.25, "Total Cost": 664766.36, "Plan Rows": 2880740, "Plan Width": 255, "Actual Startup Time": 633.325, "Actual Total Time": 1720.854, "Actual Rows": 190581, "Actual Loops": 1, "Group Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 211814.25, "Total Cost": 556738.61, "Plan Rows": 2880740, "Plan Width": 201, "Actual Startup Time": 633.295, "Actual Total Time": 1237.189, "Actual Rows": 2685453, "Actual Loops": 1, "Workers Planned": 4, "Workers Launched": 4, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 210814.19, "Total Cost": 212614.65, "Plan Rows": 720185, "Plan Width": 201, "Actual Startup Time": 621.547, "Actual Total Time": 751.184, "Actual Rows": 537091, "Actual Loops": 5, "Sort Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Sort Method": "external merge", "Sort Space Used": 83624, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 84160, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 84656, "Sort Space Type": "Disk"}, {"Worker Number": 2, "Sort Method": "external merge", "Sort Space Used": 86128, "Sort Space Type": "Disk"}, {"Worker Number": 3, "Sort Method": "external merge", "Sort Space Used": 87224, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 6586.36, "Total Cost": 69361.36, "Plan Rows": 720185, "Plan Width": 201, "Actual Startup Time": 10.852, "Actual Total Time": 156.191, "Actual Rows": 537091, "Actual Loops": 5, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 4195.54, "Total Cost": 65079.95, "Plan Rows": 720185, "Plan Width": 201, "Actual Startup Time": 8.574, "Actual Total Time": 115.565, "Actual Rows": 550130, "Actual Loops": 5, "Inner Unique": true, "Hash Cond": "(store_sales.ss_customer_sk = customer.c_customer_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 58993.85, "Plan Rows": 720185, "Plan Width": 18, "Actual Startup Time": 0.004, "Actual Total Time": 26.217, "Actual Rows": 576081, "Actual Loops": 5, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3460.24, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 8.437, "Actual Total Time": 8.438, "Actual Rows": 20000, "Actual Loops": 5, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 17472, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.0, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 0.005, "Actual Total Time": 2.761, "Actual Rows": 20000, "Actual Loops": 5, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1853.7, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 2.144, "Actual Total Time": 2.145, "Actual Rows": 14610, "Actual Loops": 5, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3968, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.987, "Actual Rows": 14610, "Actual Loops": 5, "Workers": []}]}]}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 73632.61, "Total Cost": 185717.28, "Plan Rows": 719384, "Plan Width": 255, "Actual Startup Time": 220.912, "Actual Total Time": 541.73, "Actual Rows": 56649, "Actual Loops": 1, "Group Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 73632.61, "Total Cost": 158740.38, "Plan Rows": 719384, "Plan Width": 204, "Actual Startup Time": 220.883, "Actual Total Time": 403.888, "Actual Rows": 719119, "Actual Loops": 1, "Workers Planned": 3, "Workers Launched": 3, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 72632.57, "Total Cost": 73212.72, "Plan Rows": 232059, "Plan Width": 204, "Actual Startup Time": 213.913, "Actual Total Time": 252.904, "Actual Rows": 179780, "Actual Loops": 4, "Sort Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Sort Method": "external merge", "Sort Space Used": 29160, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 28680, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 28400, "Sort Space Type": "Disk"}, {"Worker Number": 2, "Sort Method": "external merge", "Sort Space Used": 30208, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 6586.36, "Total Cost": 28949.32, "Plan Rows": 232059, "Plan Width": 204, "Actual Startup Time": 13.28, "Actual Total Time": 64.5, "Actual Rows": 179780, "Actual Loops": 4, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 4195.54, "Total Cost": 25949.31, "Plan Rows": 232059, "Plan Width": 204, "Actual Startup Time": 10.462, "Actual Total Time": 48.683, "Actual Rows": 179804, "Actual Loops": 4, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_customer_sk = customer_1.c_customer_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 21144.59, "Plan Rows": 232059, "Plan Width": 21, "Actual Startup Time": 0.006, "Actual Total Time": 11.003, "Actual Rows": 179846, "Actual Loops": 4, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3460.24, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 10.403, "Actual Total Time": 10.404, "Actual Rows": 25000, "Actual Loops": 4, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 17440, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer_1", "Startup Cost": 0.0, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 0.005, "Actual Total Time": 3.494, "Actual Rows": 25000, "Actual Loops": 4, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1853.7, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 2.632, "Actual Total Time": 2.633, "Actual Rows": 18262, "Actual Loops": 4, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3936, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 0.005, "Actual Total Time": 1.115, "Actual Rows": 18262, "Actual Loops": 4, "Workers": []}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 378045.58, "Total Cost": 378045.59, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 918269.275, "Actual Total Time": 918269.279, "Actual Rows": 88, "Actual Loops": 1, "Sort Key": ["t_s_secyear.customer_id", "t_s_secyear.customer_first_name", "t_s_secyear.customer_last_name", "t_s_secyear.customer_email_address"], "Sort Method": "quicksort", "Sort Space Used": 47, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 378045.57, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 22068.639, "Actual Total Time": 918269.083, "Actual Rows": 88, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((t_s_secyear.customer_id = t_w_secyear.customer_id) AND (CASE WHEN (t_w_firstyear.year_total > '0'::numeric) THEN (t_w_secyear.year_total / t_w_firstyear.year_total) ELSE 0.0 END > CASE WHEN (t_s_firstyear.year_total > '0'::numeric) THEN (t_s_secyear.year_total / t_s_firstyear.year_total) ELSE 0.0 END))", "Rows Removed by Join Filter": 18666980, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 288037.07, "Plan Rows": 2, "Plan Width": 712, "Actual Startup Time": 2504.417, "Actual Total Time": 892106.131, "Actual Rows": 1659, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_s_secyear.customer_id)", "Rows Removed by Join Filter": 168502791, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 198026.77, "Plan Rows": 4, "Plan Width": 200, "Actual Startup Time": 2504.411, "Actual Total Time": 815148.389, "Actual Rows": 4414, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_w_firstyear.customer_id)", "Rows Removed by Join Filter": 438082082, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_firstyear", "Startup Cost": 0.0, "Total Cost": 99003.41, "Plan Rows": 30, "Plan Width": 100, "Actual Startup Time": 633.345, "Actual Total Time": 692.594, "Actual Rows": 37923, "Actual Loops": 1, "Filter": "((year_total > '0'::numeric) AND (sale_type = 's'::text) AND (dyear = 2001))", "Rows Removed by Filter": 209307}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_firstyear", "Startup Cost": 0.0, "Total Cost": 99003.41, "Plan Rows": 30, "Plan Width": 100, "Actual Startup Time": 16.182, "Actual Total Time": 21.158, "Actual Rows": 11552, "Actual Loops": 37923, "Filter": "((year_total > '0'::numeric) AND (sale_type = 'w'::text) AND (dyear = 2001))", "Rows Removed by Filter": 235678}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_secyear", "Startup Cost": 0.0, "Total Cost": 90003.1, "Plan Rows": 90, "Plan Width": 512, "Actual Startup Time": 0.001, "Actual Total Time": 16.447, "Actual Rows": 38175, "Actual Loops": 4414, "Filter": "((sale_type = 's'::text) AND (dyear = 2002))", "Rows Removed by Filter": 209055}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_secyear", "Startup Cost": 0.0, "Total Cost": 90003.1, "Plan Rows": 90, "Plan Width": 100, "Actual Startup Time": 11.575, "Actual Total Time": 15.478, "Actual Rows": 11252, "Actual Loops": 1659, "Filter": "((sale_type = 'w'::text) AND (dyear = 2002))", "Rows Removed by Filter": 235978}]}]}]}, "Planning Time": 0.649, "Triggers": [], "Execution Time": 918284.769}