{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 20410.0, "Total Cost": 20410.02, "Plan Rows": 8, "Plan Width": 236, "Actual Startup Time": 4053.181, "Actual Total Time": 4053.31, "Actual Rows": 96, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "CTE customer_total_return", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7092.04, "Total Cost": 7161.86, "Plan Rows": 714, "Plan Width": 39, "Actual Startup Time": 16.085, "Actual Total Time": 21.338, "Actual Rows": 11877, "Actual Loops": 1, "Group Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7092.04, "Total Cost": 7148.74, "Plan Rows": 420, "Plan Width": 39, "Actual Startup Time": 16.076, "Actual Total Time": 18.481, "Actual Rows": 11912, "Actual Loops": 1, "Workers Planned": 1, "Workers Launched": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 6092.03, "Total Cost": 6101.48, "Plan Rows": 420, "Plan Width": 39, "Actual Startup Time": 15.001, "Actual Total Time": 16.57, "Actual Rows": 5956, "Actual Loops": 2, "Group Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 6092.03, "Total Cost": 6093.08, "Plan Rows": 420, "Plan Width": 13, "Actual Startup Time": 14.992, "Actual Total Time": 15.239, "Actual Rows": 6010, "Actual Loops": 2, "Sort Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Sort Method": "quicksort", "Sort Space Used": 432, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 421, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1964.08, "Total Cost": 6073.73, "Plan Rows": 420, "Plan Width": 13, "Actual Startup Time": 2.157, "Actual Total Time": 14.29, "Actual Rows": 6010, "Actual Loops": 2, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1963.79, "Total Cost": 5929.71, "Plan Rows": 420, "Plan Width": 14, "Actual Startup Time": 2.143, "Actual Total Time": 9.235, "Actual Rows": 6126, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(catalog_returns.cr_returned_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_returns", "Alias": "catalog_returns", "Startup Cost": 0.0, "Total Cost": 3743.45, "Plan Rows": 84745, "Plan Width": 18, "Actual Startup Time": 0.008, "Actual Total Time": 3.217, "Actual Rows": 72034, "Actual Loops": 2, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1961.12, "Total Cost": 1961.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 2.035, "Actual Total Time": 2.035, "Actual Rows": 182, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1961.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 1.033, "Actual Total Time": 2.016, "Actual Rows": 182, "Actual Loops": 2, "Filter": "(d_year = 1998)", "Rows Removed by Filter": 36342, "Workers": []}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.29, "Total Cost": 0.34, "Plan Rows": 1, "Plan Width": 7, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 12252, "Index Cond": "(ca_address_sk = catalog_returns.cr_returning_addr_sk)", "Rows Removed by Index Recheck": 0, "Workers": []}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 13248.14, "Total Cost": 13248.16, "Plan Rows": 8, "Plan Width": 236, "Actual Startup Time": 4053.18, "Actual Total Time": 4053.183, "Actual Rows": 96, "Actual Loops": 1, "Sort Key": ["customer.c_customer_id", "customer.c_salutation", "customer.c_first_name", "customer.c_last_name", "customer_address.ca_street_number", "customer_address.ca_street_name", "customer_address.ca_street_type", "customer_address.ca_suite_number", "customer_address.ca_city", "customer_address.ca_county", "customer_address.ca_zip", "customer_address.ca_country", "customer_address.ca_gmt_offset", "customer_address.ca_location_type", "ctr1.ctr_total_return"], "Sort Method": "quicksort", "Sort Space Used": 49, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.58, "Total Cost": 13248.02, "Plan Rows": 8, "Plan Width": 236, "Actual Startup Time": 58.718, "Actual Total Time": 4053.085, "Actual Rows": 96, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.29, "Total Cost": 13162.11, "Plan Rows": 238, "Plan Width": 116, "Actual Startup Time": 22.728, "Actual Total Time": 4050.138, "Actual Rows": 2935, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr1", "Startup Cost": 0.0, "Total Cost": 11504.33, "Plan Rows": 238, "Plan Width": 36, "Actual Startup Time": 22.717, "Actual Total Time": 4046.126, "Actual Rows": 2949, "Actual Loops": 1, "Filter": "(ctr_total_return > (SubPlan 2))", "Rows Removed by Filter": 8928, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parent Relationship": "SubPlan", "Subplan Name": "SubPlan 2", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 16.08, "Total Cost": 16.09, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 0.339, "Actual Total Time": 0.339, "Actual Rows": 1, "Actual Loops": 11877, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr2", "Startup Cost": 0.0, "Total Cost": 16.06, "Plan Rows": 4, "Plan Width": 32, "Actual Startup Time": 0.009, "Actual Total Time": 0.326, "Actual Rows": 348, "Actual Loops": 11877, "Filter": "(ctr1.ctr_state = ctr_state)", "Rows Removed by Filter": 11529}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 6.97, "Plan Rows": 1, "Plan Width": 88, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2949, "Index Cond": "(c_customer_sk = ctr1.ctr_customer_sk)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.29, "Total Cost": 0.36, "Plan Rows": 1, "Plan Width": 128, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 2935, "Index Cond": "(ca_address_sk = customer.c_current_addr_sk)", "Rows Removed by Index Recheck": 0, "Filter": "(ca_state = 'IL'::bpchar)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 0.554, "Triggers": [], "Execution Time": 4053.443}