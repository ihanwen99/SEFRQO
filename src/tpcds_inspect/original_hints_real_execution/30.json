{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 8572.1, "Total Cost": 8572.11, "Plan Rows": 4, "Plan Width": 253, "Actual Startup Time": 5342.946, "Actual Total Time": 5342.956, "Actual Rows": 92, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE customer_total_return", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 4757.51, "Total Cost": 4765.52, "Plan Rows": 356, "Plan Width": 39, "Actual Startup Time": 23.815, "Actual Total Time": 26.826, "Actual Rows": 13357, "Actual Loops": 1, "Group Key": ["web_returns.wr_returning_customer_sk", "customer_address_1.ca_state"], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 4757.51, "Total Cost": 4758.4, "Plan Rows": 356, "Plan Width": 13, "Actual Startup Time": 23.806, "Actual Total Time": 24.212, "Actual Rows": 13517, "Actual Loops": 1, "Sort Key": ["web_returns.wr_returning_customer_sk", "customer_address_1.ca_state"], "Sort Method": "quicksort", "Sort Space Used": 911, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2341.93, "Total Cost": 4742.43, "Plan Rows": 356, "Plan Width": 13, "Actual Startup Time": 4.053, "Actual Total Time": 22.236, "Actual Rows": 13517, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2341.64, "Total Cost": 4607.66, "Plan Rows": 356, "Plan Width": 14, "Actual Startup Time": 4.043, "Actual Total Time": 11.374, "Actual Rows": 13862, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_returns.wr_returned_date_sk = date_dim.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "web_returns", "Alias": "web_returns", "Startup Cost": 0.0, "Total Cost": 2077.63, "Plan Rows": 71763, "Plan Width": 18, "Actual Startup Time": 0.008, "Actual Total Time": 2.799, "Actual Rows": 71763, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2337.11, "Total Cost": 2337.11, "Plan Rows": 362, "Plan Width": 4, "Actual Startup Time": 4.027, "Actual Total Time": 4.028, "Actual Rows": 365, "Actual Loops": 1, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 21, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2337.11, "Plan Rows": 362, "Plan Width": 4, "Actual Startup Time": 2.004, "Actual Total Time": 4.006, "Actual Rows": 365, "Actual Loops": 1, "Filter": "(d_year = 2002)", "Rows Removed by Filter": 72684}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.29, "Total Cost": 0.38, "Plan Rows": 1, "Plan Width": 7, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 13862, "Index Cond": "(ca_address_sk = web_returns.wr_returning_addr_sk)", "Rows Removed by Index Recheck": 0}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 3806.58, "Total Cost": 3806.59, "Plan Rows": 4, "Plan Width": 253, "Actual Startup Time": 5342.945, "Actual Total Time": 5342.948, "Actual Rows": 92, "Actual Loops": 1, "Sort Key": ["customer.c_customer_id", "customer.c_salutation", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_day", "customer.c_birth_month", "customer.c_birth_year", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "customer.c_last_review_date", "ctr1.ctr_total_return"], "Sort Method": "quicksort", "Sort Space Used": 48, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.58, "Total Cost": 3806.54, "Plan Rows": 4, "Plan Width": 253, "Actual Startup Time": 193.319, "Actual Total Time": 5342.852, "Actual Rows": 92, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.29, "Total Cost": 3763.58, "Plan Rows": 119, "Plan Width": 257, "Actual Startup Time": 31.228, "Actual Total Time": 5340.032, "Actual Rows": 3245, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr1", "Startup Cost": 0.0, "Total Cost": 2866.69, "Plan Rows": 119, "Plan Width": 36, "Actual Startup Time": 31.216, "Actual Total Time": 5335.553, "Actual Rows": 3255, "Actual Loops": 1, "Filter": "(ctr_total_return > (SubPlan 2))", "Rows Removed by Filter": 10102, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parent Relationship": "SubPlan", "Subplan Name": "SubPlan 2", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 8.02, "Total Cost": 8.03, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 0.397, "Actual Total Time": 0.397, "Actual Rows": 1, "Actual Loops": 13357, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr2", "Startup Cost": 0.0, "Total Cost": 8.01, "Plan Rows": 2, "Plan Width": 32, "Actual Startup Time": 0.01, "Actual Total Time": 0.383, "Actual Rows": 383, "Actual Loops": 13357, "Filter": "(ctr1.ctr_state = ctr_state)", "Rows Removed by Filter": 12974}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 7.54, "Plan Rows": 1, "Plan Width": 229, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 3255, "Index Cond": "(c_customer_sk = ctr1.ctr_customer_sk)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.29, "Total Cost": 0.36, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 3245, "Index Cond": "(ca_address_sk = customer.c_current_addr_sk)", "Rows Removed by Index Recheck": 0, "Filter": "(ca_state = 'IL'::bpchar)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 0.534, "Triggers": [], "Execution Time": 5343.115}