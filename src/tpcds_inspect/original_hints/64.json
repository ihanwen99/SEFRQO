{"Plan": {"Node Type": "Sort", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 49247.89, "Total Cost": 49247.89, "Plan Rows": 1, "Plan Width": 1310, "Sort Key": ["cs1.product_name", "cs1.store_name", "cs2.cnt", "cs1.s1", "cs2.s1"], "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE cross_sales", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 49105.78, "Total Cost": 49247.81, "Plan Rows": 1, "Plan Width": 413, "Group Key": ["item.i_item_sk", "store.s_store_name", "store.s_zip", "ad1.ca_street_number", "ad1.ca_street_name", "ad1.ca_city", "ad1.ca_zip", "ad2.ca_street_number", "ad2.ca_street_name", "ad2.ca_city", "ad2.ca_zip", "d1.d_year", "d2.d_year", "d3.d_year"], "Plans": [{"Node Type": "Incremental Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 49105.78, "Total Cost": 49247.71, "Plan Rows": 2, "Plan Width": 324, "Sort Key": ["item.i_item_sk", "store.s_store_name", "store.s_zip", "ad1.ca_street_number", "ad1.ca_street_name", "ad1.ca_city", "ad1.ca_zip", "ad2.ca_street_number", "ad2.ca_street_name", "ad2.ca_city", "ad2.ca_zip", "d1.d_year", "d2.d_year", "d3.d_year"], "Presorted Key": ["item.i_item_sk"], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48963.93, "Total Cost": 49247.62, "Plan Rows": 1, "Plan Width": 324, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48963.78, "Total Cost": 49247.44, "Plan Rows": 1, "Plan Width": 328, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48963.63, "Total Cost": 49247.26, "Plan Rows": 1, "Plan Width": 332, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48963.34, "Total Cost": 49246.9, "Plan Rows": 1, "Plan Width": 296, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48963.05, "Total Cost": 49246.59, "Plan Rows": 1, "Plan Width": 260, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48962.76, "Total Cost": 49246.29, "Plan Rows": 1, "Plan Width": 260, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48962.48, "Total Cost": 49245.99, "Plan Rows": 1, "Plan Width": 260, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48962.33, "Total Cost": 49245.83, "Plan Rows": 1, "Plan Width": 264, "Inner Unique": true, "Join Filter": "(cd1.cd_marital_status <> cd2.cd_marital_status)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48961.91, "Total Cost": 49244.28, "Plan Rows": 1, "Plan Width": 270, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48961.48, "Total Cost": 49243.8, "Plan Rows": 1, "Plan Width": 272, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48961.19, "Total Cost": 49243.43, "Plan Rows": 1, "Plan Width": 272, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48960.89, "Total Cost": 49243.05, "Plan Rows": 1, "Plan Width": 272, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48960.6, "Total Cost": 49242.74, "Plan Rows": 1, "Plan Width": 256, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48960.46, "Total Cost": 49242.58, "Plan Rows": 1, "Plan Width": 98, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48960.17, "Total Cost": 49242.27, "Plan Rows": 1, "Plan Width": 98, "Inner Unique": true, "Join Filter": "(store_sales.ss_item_sk = item.i_item_sk)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48959.74, "Total Cost": 49240.93, "Plan Rows": 1, "Plan Width": 67, "Inner Unique": false, "Join Filter": "(store_returns.sr_item_sk = item.i_item_sk)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 48959.32, "Total Cost": 49235.51, "Plan Rows": 1, "Plan Width": 59, "Inner Unique": true, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 48959.02, "Total Cost": 48975.0, "Plan Rows": 35, "Plan Width": 68, "Group Key": ["catalog_sales.cs_item_sk"], "Filter": "(sum(catalog_sales.cs_ext_list_price) > ('2'::numeric * sum(((catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge) + catalog_returns.cr_store_credit))))", "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 48959.02, "Total Cost": 48971.59, "Plan Rows": 105, "Plan Width": 29, "Workers Planned": 4, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 47958.96, "Total Cost": 47959.03, "Plan Rows": 26, "Plan Width": 29, "Sort Key": ["catalog_sales.cs_item_sk"], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5014.63, "Total Cost": 47958.35, "Plan Rows": 26, "Plan Width": 29, "Inner Unique": true, "Hash Cond": "((catalog_sales.cs_item_sk = catalog_returns.cr_item_sk) AND (catalog_sales.cs_order_number = catalog_returns.cr_order_number))", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_sales", "Alias": "catalog_sales", "Startup Cost": 0.0, "Total Cost": 41051.75, "Plan Rows": 360375, "Plan Width": 15}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3743.45, "Total Cost": 3743.45, "Plan Rows": 84745, "Plan Width": 26, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_returns", "Alias": "catalog_returns", "Startup Cost": 0.0, "Total Cost": 3743.45, "Plan Rows": 84745, "Plan Width": 26}]}]}]}]}]}, {"Node Type": "Memoize", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.3, "Total Cost": 7.42, "Plan Rows": 1, "Plan Width": 55, "Cache Key": "catalog_sales.cs_item_sk", "Cache Mode": "logical", "Plans": [{"Node Type": "Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "item_pkey", "Relation Name": "item", "Alias": "item", "Startup Cost": 0.29, "Total Cost": 7.41, "Plan Rows": 1, "Plan Width": 55, "Index Cond": "(i_item_sk = catalog_sales.cs_item_sk)", "Filter": "((i_current_price >= '64'::numeric) AND (i_current_price <= '74'::numeric) AND (i_current_price >= '65'::numeric) AND (i_current_price <= '79'::numeric) AND (i_color = ANY ('{purple,burlywood,indian,spring,floral,medium}'::bpchar[])))"}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "store_returns_pkey", "Relation Name": "store_returns", "Alias": "store_returns", "Startup Cost": 0.42, "Total Cost": 5.19, "Plan Rows": 18, "Plan Width": 8, "Index Cond": "(sr_item_sk = catalog_sales.cs_item_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "store_sales_pkey", "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.43, "Total Cost": 1.32, "Plan Rows": 1, "Plan Width": 51, "Index Cond": "((ss_item_sk = store_returns.sr_item_sk) AND (ss_ticket_number = store_returns.sr_ticket_number))"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "d1", "Startup Cost": 0.29, "Total Cost": 0.31, "Plan Rows": 1, "Plan Width": 8, "Index Cond": "(d_date_sk = store_sales.ss_sold_date_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "store_pkey", "Relation Name": "store", "Alias": "store", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 166, "Index Cond": "(s_store_sk = store_sales.ss_store_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 0.31, "Plan Rows": 1, "Plan Width": 24, "Index Cond": "(c_customer_sk = store_sales.ss_customer_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "d2", "Startup Cost": 0.29, "Total Cost": 0.38, "Plan Rows": 1, "Plan Width": 8, "Index Cond": "(d_date_sk = customer.c_first_sales_date_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "d3", "Startup Cost": 0.29, "Total Cost": 0.38, "Plan Rows": 1, "Plan Width": 8, "Index Cond": "(d_date_sk = customer.c_first_shipto_date_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_demographics_pkey", "Relation Name": "customer_demographics", "Alias": "cd1", "Startup Cost": 0.43, "Total Cost": 0.48, "Plan Rows": 1, "Plan Width": 6, "Index Cond": "(cd_demo_sk = store_sales.ss_cdemo_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_demographics_pkey", "Relation Name": "customer_demographics", "Alias": "cd2", "Startup Cost": 0.43, "Total Cost": 1.53, "Plan Rows": 1, "Plan Width": 6, "Index Cond": "(cd_demo_sk = customer.c_current_cdemo_sk)"}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "promotion_pkey", "Relation Name": "promotion", "Alias": "promotion", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Index Cond": "(p_promo_sk = store_sales.ss_promo_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "household_demographics_pkey", "Relation Name": "household_demographics", "Alias": "hd1", "Startup Cost": 0.28, "Total Cost": 0.3, "Plan Rows": 1, "Plan Width": 8, "Index Cond": "(hd_demo_sk = store_sales.ss_hdemo_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "household_demographics_pkey", "Relation Name": "household_demographics", "Alias": "hd2", "Startup Cost": 0.28, "Total Cost": 0.3, "Plan Rows": 1, "Plan Width": 8, "Index Cond": "(hd_demo_sk = customer.c_current_hdemo_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "ad1", "Startup Cost": 0.29, "Total Cost": 0.31, "Plan Rows": 1, "Plan Width": 44, "Index Cond": "(ca_address_sk = store_sales.ss_addr_sk)"}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "ad2", "Startup Cost": 0.29, "Total Cost": 0.36, "Plan Rows": 1, "Plan Width": 44, "Index Cond": "(ca_address_sk = customer.c_current_addr_sk)"}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "income_band_pkey", "Relation Name": "income_band", "Alias": "ib1", "Startup Cost": 0.15, "Total Cost": 0.18, "Plan Rows": 1, "Plan Width": 4, "Index Cond": "(ib_income_band_sk = hd1.hd_income_band_sk)"}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "income_band_pkey", "Relation Name": "income_band", "Alias": "ib2", "Startup Cost": 0.15, "Total Cost": 0.18, "Plan Rows": 1, "Plan Width": 4, "Index Cond": "(ib_income_band_sk = hd2.hd_income_band_sk)"}]}]}]}, {"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 0.07, "Plan Rows": 1, "Plan Width": 1310, "Inner Unique": false, "Join Filter": "((cs2.cnt <= cs1.cnt) AND (cs1.item_sk = cs2.item_sk) AND ((cs1.store_name)::text = (cs2.store_name)::text) AND (cs1.store_zip = cs2.store_zip))", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "cross_sales", "Alias": "cs1", "Startup Cost": 0.0, "Total Cost": 0.02, "Plan Rows": 1, "Plan Width": 1206, "Filter": "(syear = 1999)"}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "cross_sales", "Alias": "cs2", "Startup Cost": 0.0, "Total Cost": 0.02, "Plan Rows": 1, "Plan Width": 274, "Filter": "(syear = 2000)"}]}]}}