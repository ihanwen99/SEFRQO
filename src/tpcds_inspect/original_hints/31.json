{"Plan": {"Node Type": "Nested Loop", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 553796.89, "Total Cost": 683098.59, "Plan Rows": 1, "Plan Width": 210, "Inner Unique": false, "Join Filter": "(((ss1.ca_county)::text = (ws2.ca_county)::text) AND (CASE WHEN (ws1.web_sales > '0'::numeric) THEN ((ws2.web_sales * 1.0000) / ws1.web_sales) ELSE NULL::numeric END > CASE WHEN (ss1.store_sales > '0'::numeric) THEN ((ss2.store_sales * 1.0000) / ss1.store_sales) ELSE NULL::numeric END) AND (CASE WHEN (ws2.web_sales > '0'::numeric) THEN ((ws3.web_sales * 1.0000) / ws2.web_sales) ELSE NULL::numeric END > CASE WHEN (ss2.store_sales > '0'::numeric) THEN ((ss3.store_sales * 1.0000) / ss2.store_sales) ELSE NULL::numeric END))", "Plans": [{"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ss", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 345015.59, "Total Cost": 402953.01, "Plan Rows": 1484184, "Plan Width": 54, "Group Key": ["customer_address.ca_county", "date_dim.d_qoy", "date_dim.d_year"], "Planned Partitions": 32, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5328.6, "Total Cost": 101052.92, "Plan Rows": 2880740, "Plan Width": 28, "Inner Unique": true, "Hash Cond": "(store_sales.ss_addr_sk = customer_address.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3067.6, "Total Cost": 91229.37, "Plan Rows": 2880740, "Plan Width": 18, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 80599.4, "Plan Rows": 2880740, "Plan Width": 14}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2154.49, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1636.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ws", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 96046.31, "Total Cost": 114873.94, "Plan Rows": 719384, "Plan Width": 54, "Group Key": ["customer_address_1.ca_county", "date_dim_1.d_qoy", "date_dim_1.d_year"], "Planned Partitions": 16, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5328.6, "Total Cost": 35123.48, "Plan Rows": 719384, "Plan Width": 28, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_addr_sk = customer_address_1.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3067.6, "Total Cost": 30973.94, "Plan Rows": 719384, "Plan Width": 18, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 26017.84, "Plan Rows": 719384, "Plan Width": 14}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2154.49, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 2154.49, "Plan Rows": 73049, "Plan Width": 12}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1636.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.0, "Total Cost": 1636.0, "Plan Rows": 50000, "Plan Width": 18}]}]}]}, {"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 147286.17, "Plan Rows": 1, "Plan Width": 554, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss3.ca_county)::text)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 110181.11, "Plan Rows": 1, "Plan Width": 444, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss2.ca_county)::text)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 73076.05, "Plan Rows": 1, "Plan Width": 334, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ws1.ca_county)::text)", "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 35969.95, "Total Cost": 35970.15, "Plan Rows": 2, "Plan Width": 220, "Inner Unique": false, "Merge Cond": "((ws1.ca_county)::text = (ws3.ca_county)::text)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 17984.98, "Total Cost": 17985.02, "Plan Rows": 18, "Plan Width": 110, "Sort Key": ["ws1.ca_county"], "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws1", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Filter": "((d_qoy = 1) AND (d_year = 2000))"}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 17984.98, "Total Cost": 17985.02, "Plan Rows": 18, "Plan Width": 110, "Sort Key": ["ws3.ca_county"], "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws3", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Filter": "((d_year = 2000) AND (d_qoy = 3))"}]}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss1", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 114, "Filter": "((d_qoy = 1) AND (d_year = 2000))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss2", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Filter": "((d_year = 2000) AND (d_qoy = 2))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss3", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Filter": "((d_year = 2000) AND (d_qoy = 3))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws2", "Startup Cost": 0.0, "Total Cost": 17984.6, "Plan Rows": 18, "Plan Width": 110, "Filter": "((d_year = 2000) AND (d_qoy = 2))"}]}}