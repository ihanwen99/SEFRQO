{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2058274.66, "Total Cost": 2058274.66, "Plan Rows": 1, "Plan Width": 480, "Plans": [{"Node Type": "Append", "Parent Relationship": "InitPlan", "Subplan Name": "CTE year_total", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 214278.25, "Total Cost": 1264160.65, "Plan Rows": 5041625, "Plan Width": 255, "Subplans Removed": 0, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 214278.25, "Total Cost": 688835.91, "Plan Rows": 2880740, "Plan Width": 255, "Group Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 214278.25, "Total Cost": 559202.61, "Plan Rows": 2880740, "Plan Width": 213, "Workers Planned": 4, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 213278.19, "Total Cost": 215078.65, "Plan Rows": 720185, "Plan Width": 213, "Sort Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 6586.36, "Total Cost": 69361.36, "Plan Rows": 720185, "Plan Width": 213, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 4195.54, "Total Cost": 65079.95, "Plan Rows": 720185, "Plan Width": 213, "Inner Unique": true, "Hash Cond": "(store_sales.ss_customer_sk = customer.c_customer_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 58993.85, "Plan Rows": 720185, "Plan Width": 30}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3460.24, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.0, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1853.7, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8}]}]}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 120744.3, "Total Cost": 358209.45, "Plan Rows": 1441501, "Plan Width": 255, "Group Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 120744.3, "Total Cost": 293341.9, "Plan Rows": 1441501, "Plan Width": 216, "Workers Planned": 4, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 119744.24, "Total Cost": 120645.18, "Plan Rows": 360375, "Plan Width": 216, "Sort Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 6586.36, "Total Cost": 49530.18, "Plan Rows": 360375, "Plan Width": 216, "Inner Unique": true, "Hash Cond": "(catalog_sales.cs_sold_date_sk = date_dim_1.d_date_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 4195.54, "Total Cost": 46193.32, "Plan Rows": 360375, "Plan Width": 216, "Inner Unique": true, "Hash Cond": "(catalog_sales.cs_bill_customer_sk = customer_1.c_customer_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_sales", "Alias": "catalog_sales", "Startup Cost": 0.0, "Total Cost": 41051.75, "Plan Rows": 360375, "Plan Width": 33}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3460.24, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer_1", "Startup Cost": 0.0, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1853.7, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8}]}]}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 74427.11, "Total Cost": 191907.16, "Plan Rows": 719384, "Plan Width": 255, "Group Key": ["customer_2.c_customer_id", "customer_2.c_first_name", "customer_2.c_last_name", "customer_2.c_preferred_cust_flag", "customer_2.c_birth_country", "customer_2.c_login", "customer_2.c_email_address", "date_dim_2.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 74427.11, "Total Cost": 159534.88, "Plan Rows": 719384, "Plan Width": 216, "Workers Planned": 3, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 73427.07, "Total Cost": 74007.22, "Plan Rows": 232059, "Plan Width": 216, "Sort Key": ["customer_2.c_customer_id", "customer_2.c_first_name", "customer_2.c_last_name", "customer_2.c_preferred_cust_flag", "customer_2.c_birth_country", "customer_2.c_login", "customer_2.c_email_address", "date_dim_2.d_year"], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 6586.36, "Total Cost": 28949.32, "Plan Rows": 232059, "Plan Width": 216, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_2.d_date_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 4195.54, "Total Cost": 25949.31, "Plan Rows": 232059, "Plan Width": 216, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_customer_sk = customer_2.c_customer_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 21144.59, "Plan Rows": 232059, "Plan Width": 33}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3460.24, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer_2", "Startup Cost": 0.0, "Total Cost": 3460.24, "Plan Rows": 58824, "Plan Width": 191}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1853.7, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_2", "Startup Cost": 0.0, "Total Cost": 1853.7, "Plan Rows": 42970, "Plan Width": 8}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 794114.01, "Total Cost": 794114.02, "Plan Rows": 1, "Plan Width": 480, "Sort Key": ["t_s_secyear.customer_id", "t_s_secyear.customer_first_name", "t_s_secyear.customer_last_name", "t_s_secyear.customer_email_address"], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 794114.0, "Plan Rows": 1, "Plan Width": 480, "Inner Unique": false, "Join Filter": "((t_s_secyear.customer_id = t_w_secyear.customer_id) AND (CASE WHEN (t_c_firstyear.year_total > '0'::numeric) THEN (t_c_secyear.year_total / t_c_firstyear.year_total) ELSE NULL::numeric END > CASE WHEN (t_w_firstyear.year_total > '0'::numeric) THEN (t_w_secyear.year_total / t_w_firstyear.year_total) ELSE NULL::numeric END))", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 668070.23, "Plan Rows": 1, "Plan Width": 848, "Inner Unique": false, "Join Filter": "((t_s_secyear.customer_id = t_c_secyear.customer_id) AND (CASE WHEN (t_c_firstyear.year_total > '0'::numeric) THEN (t_c_secyear.year_total / t_c_firstyear.year_total) ELSE NULL::numeric END > CASE WHEN (t_s_firstyear.year_total > '0'::numeric) THEN (t_s_secyear.year_total / t_s_firstyear.year_total) ELSE NULL::numeric END))", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 542026.45, "Plan Rows": 1, "Plan Width": 812, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_s_secyear.customer_id)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 415981.42, "Plan Rows": 2, "Plan Width": 300, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_w_firstyear.customer_id)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 277328.65, "Plan Rows": 9, "Plan Width": 200, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_c_firstyear.customer_id)", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_firstyear", "Startup Cost": 0.0, "Total Cost": 138644.69, "Plan Rows": 42, "Plan Width": 100, "Filter": "((year_total > '0'::numeric) AND (sale_type = 's'::text) AND (dyear = 2001))"}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_c_firstyear", "Startup Cost": 0.0, "Total Cost": 138644.69, "Plan Rows": 42, "Plan Width": 100, "Filter": "((year_total > '0'::numeric) AND (sale_type = 'c'::text) AND (dyear = 2001))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_firstyear", "Startup Cost": 0.0, "Total Cost": 138644.69, "Plan Rows": 42, "Plan Width": 100, "Filter": "((year_total > '0'::numeric) AND (sale_type = 'w'::text) AND (dyear = 2001))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_secyear", "Startup Cost": 0.0, "Total Cost": 126040.62, "Plan Rows": 126, "Plan Width": 512, "Filter": "((sale_type = 's'::text) AND (dyear = 2002))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_c_secyear", "Startup Cost": 0.0, "Total Cost": 126040.62, "Plan Rows": 126, "Plan Width": 100, "Filter": "((sale_type = 'c'::text) AND (dyear = 2002))"}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_secyear", "Startup Cost": 0.0, "Total Cost": 126040.62, "Plan Rows": 126, "Plan Width": 100, "Filter": "((sale_type = 'w'::text) AND (dyear = 2002))"}]}]}]}}